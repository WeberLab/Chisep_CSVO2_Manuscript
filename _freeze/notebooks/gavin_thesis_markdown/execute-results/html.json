{
  "hash": "762a6e7303e151b543ca12bc769a4054",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"gavin_thesis_R\"\nauthor: \"Gavin\"\ndate: \"2024-04-30\"\noutput: html_document\n---\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\n#| label = \"setup\",\n#| include = FALSE\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggstatsplot)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nYou can cite this package as:\n     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.\n     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rstatix)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'rstatix'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\n```\n:::\n\n\n\n\n\n\nLoad main dataframe (change directory as needed)\n*note: columns titled with with \"Gavin_x_x\" contain QSM data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnewdata <- read.csv(\"newdata.csv\")\n\nsignif=\"***\"\nnotsig=\"n.s.\"\n\nsigfunc <- function(pval) {\nif (pval < 0.05){\n  label = signif\n} else {\n    label = notsig\n}\n  return (label)\n}\n```\n:::\n\n\n\n\n\n\nDataframes for figures\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| echo = FALSE\n\n#QSM chi data - SSS vs. CCV\ncomp_legit_starfsl <- data.frame(\n  Chi = c(newdata$Gavin_SSS_Chi, newdata$Gavin_IntVein_Chi),\n  Vein = c(rep(\"Superior Sagittal Sinus\", 19), rep(\"Central Cerebral Veins\", 19))\n)\n\n#QSM CSvO2 data - SSS vs. CCV\ncomp_SSS_IntVein_CSvO2 <- data.frame(\n  CSvO2 = c(newdata$Gavin_IntVein_CSvO2, newdata$Gavin_SSSVein_CSvO2),\n  Vein = c(rep(\"Central Cerebral Veins\", 19), rep(\"Superior Sagittal Sinus\", 19))\n)\n\n#Chisep chi data - SSS vs. CCV\ncomp_chisep_chi <- data.frame(\n  Chi = c(newdata$Chisep_IntVein_Chi, newdata$Chisep_SSS_Chi),\n  Vein = c(rep(\"Central Cerebral Veins\", 19), rep(\"Superior Sagittal Sinus\", 19))\n)\n\n#Chisep CSvO2 data - SSS vs. CCV\ncomp_chisep_CSvO2 <- data.frame(\n  CSvO2 = c(newdata$Chisep_IntVein_CSvO2, newdata$Chisep_SSSVein_CSvO2),\n  Vein = c(rep(\"Central Cerebral Veins\", 19), rep(\"Superior Sagittal Sinus\", 19))\n)\n\n#QSM SSS chi vs. chisep SSS chi\ncomp_SSS_chi <-  data.frame(\n  \"Measured Susceptibility\" = \n    c(newdata$Gavin_SSS_Chi, newdata$Chisep_SSS_Chi),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n\n#QSM CCV chi vs. chisep CCV chi\ncomp_CCV_chi <- data.frame(\n  Chi = \n    c(newdata$Gavin_IntVein_Chi, newdata$Chisep_IntVein_Chi),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n\n#QSM SSS SvO2 vs. chisep SSS SvO2\ncomp_SSS_SvO2 <- data.frame(\n  \"Oxygen Saturation\" = \n    c(newdata$Gavin_SSSVein_CSvO2, newdata$Chisep_SSSVein_CSvO2),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n\n#QSM CCV SvO2 vs. chisep CCV SvO2\ncomp_CCV_SvO2 <- data.frame(\n  \"Oxygen Saturation\" = \n    c(newdata$Gavin_IntVein_CSvO2, newdata$Chisep_IntVein_CSvO2),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SSS Chi\nSSSChi.t <- tidy(t.test(newdata$Gavin_SSS_Chi, newdata$Chisep_SSS_Chi,\n            paired = TRUE, conf.int = TRUE))\n\n#SSS SvO2\nSSSSvO2.t <- tidy(t.test(newdata$Gavin_SSSVein_CSvO2, newdata$Chisep_SSSVein_CSvO2,\n            paired = TRUE, conf.int = TRUE))\n\n#CCV Chi\nCCVChi.t <- tidy(t.test(newdata$Gavin_IntVein_Chi, newdata$Chisep_IntVein_Chi, paired = TRUE,\n            conf.int = TRUE))\n\n#CCV SvO2\nCCVSvO2.t <- tidy(t.test(newdata$Gavin_IntVein_CSvO2, newdata$Chisep_IntVein_CSvO2,\n            paired = TRUE, conf.int = TRUE))\n```\n:::\n\n\n\n\n\n\nFigure 3.1\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| echo = FALSE\nlabel = sigfunc(SSSChi.t$p.value)\nm1 <- ggwithinstats(\n  data = comp_CCV_chi,\n  x = Method,\n  y = Chi,\n  ylab = \"Chi (ppm)\",\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\")) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_CCV_chi$Chi)*1.05), size=4, label = label)\n\nlabel = sigfunc(SSSSvO2.t$p.value)\nm2 <- ggwithinstats( \n  data = comp_SSS_chi,\n  x = Method,\n  y = Measured.Susceptibility, \n  ylab = \"Chi (ppm)\",\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\")) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_SSS_chi$Measured.Susceptibility)*1.05), size=4, label = label )\n\nlabel = sigfunc(CCVChi.t$p.value)\nm3 <- ggwithinstats(\n  data = comp_CCV_SvO2,\n  x = Method,\n  y = Oxygen.Saturation,\n  ylab = \"SvO2 (%)\",\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\") ) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_CCV_SvO2$Oxygen.Saturation)*1.05), size=4, label = label )\n\nlabel = sigfunc(CCVSvO2.t$p.value)\nm4 <- ggwithinstats(\n  data = comp_SSS_SvO2,\n  x = Method,\n  y = Oxygen.Saturation,\n  ylab = \"SvO2 (%)\",\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\") ) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_SSS_SvO2$Oxygen.Saturation)*1.05), size=4, label = label )\n(patch1 <- (m1 + m2)/(m3 + m4) + \n  plot_annotation(tag_levels = 'A') & \n  theme(plot.tag = element_text(size = 10)))\n```\n\n::: {.cell-output-display}\n![](gavin_thesis_markdown_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {#cell-fig-methodplot .cell}\n\n```{.r .cell-code}\n#| label: fig-methodplot\n#| fig-width: 8\n#| fig-height: 5\n#| fig-cap: \"Vein-specific susceptibility and oxygen saturation values by method. (A, B) contains violin plots comparing subject χ (ppm) acquired from QSM (A) and its paramagnetic component (B); (C, D) contains violin plots comparing subject SvO2 (%) acquired from QSM (C) and its paramagnetic component (D). Raw data points from paramagnetic maps are shown as filled green circles and raw data points from QSM are shown as filled orange circles. Each line connects the raw data points of a single subject. (***) indicates P<0.05.\"\npatch1\n```\n\n::: {.cell-output-display}\n![Vein-specific susceptibility and oxygen saturation values by method. (A, B) contains violin plots comparing subject χ (ppm) acquired from QSM (A) and its paramagnetic component (B); (C, D) contains violin plots comparing subject SvO2 (%) acquired from QSM (C) and its paramagnetic component (D). Raw data points from paramagnetic maps are shown as filled green circles and raw data points from QSM are shown as filled orange circles. Each line connects the raw data points of a single subject. (***) indicates P<0.05.](gavin_thesis_markdown_files/figure-html/fig-methodplot-1.png){#fig-methodplot width=768}\n:::\n:::\n\n\n\n\n\n\n# Region analysis: Chi and CSvO2\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#SSS Chi\nRegionQSMChi.t <- tidy(t.test(newdata$Gavin_IntVein_Chi, newdata$Gavin_SSS_Chi, \n            paired = TRUE, conf.int = TRUE))\n\n#SSS SvO2\nRegionQSMSvO2.t <- tidy(t.test(newdata$Gavin_IntVein_CSvO2, newdata$Gavin_SSSVein_CSvO2,\n            paired = TRUE, conf.int = TRUE))\n\n#CCV Chi\nRegionChisepChi.t <- tidy(t.test(newdata$Chisep_IntVein_Chi, newdata$Chisep_SSS_Chi, paired = TRUE,\n            conf.int = TRUE))\n\n#CCV SvO2\nRegionChisepSvO2.t <- tidy(t.test(newdata$Chisep_IntVein_CSvO2, newdata$Chisep_SSSVein_CSvO2,\n            paired = TRUE, conf.int = TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlabel = sigfunc(RegionQSMChi.t$p.value)\n p1 <- ggwithinstats(\n  data = comp_legit_starfsl,\n  x = Vein,\n  y = Chi,\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"Chi (ppm)\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#D95F02\")) + \n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_legit_starfsl$Chi)*1.05), size=4, label = label)\n\nlabel = sigfunc(RegionQSMSvO2.t$p.value)\np2 <- ggwithinstats(\n  data = comp_SSS_IntVein_CSvO2,\n  x = Vein,\n  y = CSvO2,\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"SvO2 (%)\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#D95F02\")\n) + \n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_SSS_IntVein_CSvO2$CSvO2)*1.05), size=4, label = label)\n\nlabel = sigfunc(RegionChisepChi.t$p.value)\np3 <- ggwithinstats(                     #boxplot of chi comparison between regions\n  data = comp_chisep_chi,\n  x = Vein,\n  y = Chi, \n  results.subtitle = FALSE,\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"Chi (ppm)\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#1B9E77\")\n) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_chisep_chi$Chi))*1.05, size=4, label = label)\n\nlabel = sigfunc(RegionChisepSvO2.t$p.value)\np4 <- ggwithinstats(                    #boxplot of svo2 comparison between regions\n  data = comp_chisep_CSvO2,\n  x = Vein,\n  y = CSvO2, \n  results.subtitle = FALSE,\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"SvO2 (%)\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#1B9E77\")\n) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_chisep_CSvO2$CSvO2)*1.05), size=4, label = label)\n\n(patch2 <- (p1 + p2)/(p3 + p4) + \n  plot_annotation(tag_levels = 'A') & \n  theme(plot.tag = element_text(size = 10)))\n```\n\n::: {.cell-output-display}\n![](gavin_thesis_markdown_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n::: {#cell-fig-regionplot .cell}\n\n```{.r .cell-code}\n#| label: fig-regionplot\n#| fig-width: 8\n#| fig-height: 5\n#| fig-cap: \"Inter-venous comparisons of susceptibility and oxygen saturation. Violin plots comparing (A, C) χ (ppm) and (B, D) SvO2 (%) between the CCV and the SSS. Panels (A) and (B) used data acquired from QSM, and its raw data points are shown as filled orange circles. Panels (C) and (D) used data acquired from paramagnetic maps, and its raw data points are shown as filled green circles. Each line connects the raw data points of a single subject. (***) indicates p<0.05; (n.s.) indicates no significant difference.\"\npatch2\n```\n\n::: {.cell-output-display}\n![Inter-venous comparisons of susceptibility and oxygen saturation. Violin plots comparing (A, C) χ (ppm) and (B, D) SvO2 (%) between the CCV and the SSS. Panels (A) and (B) used data acquired from QSM, and its raw data points are shown as filled orange circles. Panels (C) and (D) used data acquired from paramagnetic maps, and its raw data points are shown as filled green circles. Each line connects the raw data points of a single subject. (***) indicates p<0.05; (n.s.) indicates no significant difference.](gavin_thesis_markdown_files/figure-html/fig-regionplot-1.png){#fig-regionplot width=768}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsave.image('results.RData')\n```\n:::",
    "supporting": [
      "gavin_thesis_markdown_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}