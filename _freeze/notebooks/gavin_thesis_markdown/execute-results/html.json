{
  "hash": "7194b7aceebd42107bce2164a973872b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"gavin_thesis_R\"\nauthor: \"Gavin\"\ndate: \"2024-04-30\"\noutput: html_document\n---\n\n::: {.cell .hidden}\n\n```{.r .cell-code .hidden}\n#| label = \"setup\",\n#| include = FALSE\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(ggstatsplot)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nYou can cite this package as:\n     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.\n     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rstatix)\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\n\nAttaching package: 'rstatix'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nThe following object is masked from 'package:stats':\n\n    filter\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\n```\n:::\n\n\nLoad main dataframe (change directory as needed)\n*note: columns titled with with \"Gavin_x_x\" contain QSM data\n\n::: {.cell}\n\n```{.r .cell-code}\nnewdata <- read.csv(\"newdata.csv\")\n```\n:::\n\n\nDataframes for figures\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| echo = FALSE\n\n#QSM chi data - SSS vs. CCV\ncomp_legit_starfsl <- data.frame(\n  Chi = c(newdata$Gavin_SSS_Chi, newdata$Gavin_IntVein_Chi),\n  Vein = c(rep(\"Superior Sagittal Sinus\", 19), rep(\"Central Cerebral Veins\", 19))\n)\n\n#QSM CSvO2 data - SSS vs. CCV\ncomp_SSS_IntVein_CSvO2 <- data.frame(\n  CSvO2 = c(newdata$Gavin_IntVein_CSvO2, newdata$Gavin_SSSVein_CSvO2),\n  Vein = c(rep(\"Central Cerebral Veins\", 19), rep(\"Superior Sagittal Sinus\", 19))\n)\n\n#Chisep chi data - SSS vs. CCV\ncomp_chisep_chi <- data.frame(\n  Chi = c(newdata$Chisep_IntVein_Chi, newdata$Chisep_SSS_Chi),\n  Vein = c(rep(\"Central Cerebral Veins\", 19), rep(\"Superior Sagittal Sinus\", 19))\n)\n\n#Chisep CSvO2 data - SSS vs. CCV\ncomp_chisep_CSvO2 <- data.frame(\n  CSvO2 = c(newdata$Chisep_IntVein_CSvO2, newdata$Chisep_SSSVein_CSvO2),\n  Vein = c(rep(\"Central Cerebral Veins\", 19), rep(\"Superior Sagittal Sinus\", 19))\n)\n\n#QSM SSS chi vs. chisep SSS chi\ncomp_SSS_chi <-  data.frame(\n  \"Measured Susceptibility\" = \n    c(newdata$Gavin_SSS_Chi, newdata$Chisep_SSS_Chi),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n\n#QSM CCV chi vs. chisep CCV chi\ncomp_CCV_chi <- data.frame(\n  Chi = \n    c(newdata$Gavin_IntVein_Chi, newdata$Chisep_IntVein_Chi),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n\n#QSM SSS SvO2 vs. chisep SSS SvO2\ncomp_SSS_SvO2 <- data.frame(\n  \"Oxygen Saturation\" = \n    c(newdata$Gavin_SSSVein_CSvO2, newdata$Chisep_SSSVein_CSvO2),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n\n#QSM CCV SvO2 vs. chisep CCV SvO2\ncomp_CCV_SvO2 <- data.frame(\n  \"Oxygen Saturation\" = \n    c(newdata$Gavin_IntVein_CSvO2, newdata$Chisep_IntVein_CSvO2),\n  Method = c(rep(\"QSM\", 19), rep(\"Paramagnetic Component\", 19))\n)\n```\n:::\n\n\nWilcox test for p-values and 95% CI - table 3.2\n\n::: {.cell}\n\n```{.r .cell-code}\n#SSS Chi\nwilcox.test(newdata$Gavin_SSS_Chi, newdata$Chisep_SSS_Chi,\n            paired = TRUE, conf.int = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  newdata$Gavin_SSS_Chi and newdata$Chisep_SSS_Chi\nV = 0, p-value = 3.815e-06\nalternative hypothesis: true location shift is not equal to 0\n95 percent confidence interval:\n -0.1275045 -0.0918990\nsample estimates:\n(pseudo)median \n     -0.112651 \n```\n\n\n:::\n\n```{.r .cell-code}\n#SSS SvO2\nwilcox.test(newdata$Gavin_SSSVein_CSvO2, newdata$Chisep_SSSVein_CSvO2,\n            paired = TRUE, conf.int = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  newdata$Gavin_SSSVein_CSvO2 and newdata$Chisep_SSSVein_CSvO2\nV = 190, p-value = 3.815e-06\nalternative hypothesis: true location shift is not equal to 0\n95 percent confidence interval:\n 0.1164479 0.1650219\nsample estimates:\n(pseudo)median \n     0.1392186 \n```\n\n\n:::\n\n```{.r .cell-code}\n#CCV Chi\nwilcox.test(newdata$Gavin_IntVein_Chi, newdata$Chisep_IntVein_Chi, paired = TRUE,\n            conf.int = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  newdata$Gavin_IntVein_Chi and newdata$Chisep_IntVein_Chi\nV = 0, p-value = 3.815e-06\nalternative hypothesis: true location shift is not equal to 0\n95 percent confidence interval:\n -0.094404 -0.069646\nsample estimates:\n(pseudo)median \n   -0.08242075 \n```\n\n\n:::\n\n```{.r .cell-code}\n#CCV SvO2\nwilcox.test(newdata$Gavin_IntVein_CSvO2, newdata$Chisep_IntVein_CSvO2,\n            paired = TRUE, conf.int = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon signed rank exact test\n\ndata:  newdata$Gavin_IntVein_CSvO2 and newdata$Chisep_IntVein_CSvO2\nV = 190, p-value = 3.815e-06\nalternative hypothesis: true location shift is not equal to 0\n95 percent confidence interval:\n 0.0890358 0.1329288\nsample estimates:\n(pseudo)median \n     0.1069435 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#SSS Chi\nSSSChi.t <- tidy(t.test(newdata$Gavin_SSS_Chi, newdata$Chisep_SSS_Chi,\n            paired = TRUE, conf.int = TRUE))\n\n#SSS SvO2\nSSSSvO2.t <- tidy(t.test(newdata$Gavin_SSSVein_CSvO2, newdata$Chisep_SSSVein_CSvO2,\n            paired = TRUE, conf.int = TRUE))\n\n#CCV Chi\nCCVChi.t <- tidy(t.test(newdata$Gavin_IntVein_Chi, newdata$Chisep_IntVein_Chi, paired = TRUE,\n            conf.int = TRUE))\n\n#CCV SvO2\nCCVSvO2.t <- tidy(t.test(newdata$Gavin_IntVein_CSvO2, newdata$Chisep_IntVein_CSvO2,\n            paired = TRUE, conf.int = TRUE))\n```\n:::\n\n\n\nFigure 3.1\n*note: \"****\" in panels were added outside of R\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| echo = FALSE\nm1 <- ggwithinstats(\n  data = comp_CCV_chi,\n  x = Method,\n  y = Chi,\n  results.subtitle = FALSE,\n  title = \"(A)\",\n  subtitle = \"Central Cerebral Veins\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\")\n)\n\nm2 <- ggwithinstats( \n  data = comp_SSS_chi,\n  x = Method,\n  y = Measured.Susceptibility, \n  ylab = \"Chi\",\n  results.subtitle = FALSE,\n  title = \"\",\n  subtitle = \"Superior Sagittal Sinus\",\n  type = \"nonparametric\", \n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\")\n)\n\nm3 <- ggwithinstats(\n  data = comp_CCV_SvO2,\n  x = Method,\n  y = Oxygen.Saturation,\n  ylab = \"SvO2\",\n  results.subtitle = FALSE,\n  title = \"(B)\",\n  subtitle = \"Central Cerebral Veins\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\")\n)\n\nm4 <- ggwithinstats(\n  data = comp_SSS_SvO2,\n  x = Method,\n  y = Oxygen.Saturation,\n  pairwise.display = \"all\",\n  ylab = \"SvO2\",\n  results.subtitle = FALSE,\n  title = \"\",\n  subtitle = \"Superior Sagittal Sinus\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\")\n)\n\ncombine_plots(\n  plotlist = list(m1, m2, m3, m4),\n  plotgrid.args = list(nrow = 2)\n)\n```\n\n::: {.cell-output-display}\n![](gavin_thesis_markdown_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nFigure 3.2\n*note: \"****\" in panels (a) and (b) were added outside of R\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| echo = FALSE\np1 <- ggwithinstats(\n  data = comp_legit_starfsl,\n  x = Vein,\n  y = Chi,\n  pairwise.display = \"all\",\n  results.subtitle = FALSE,\n  xlab = \"Region\",\n  ylab = \"Chi\",\n  title = \"(A)\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#D95F02\") \n)\n\np2 <- ggwithinstats(\n  data = comp_SSS_IntVein_CSvO2,\n  x = Vein,\n  y = CSvO2,\n  pairwise.display = \"all\",\n  results.subtitle = FALSE,\n  xlab = \"Region\",\n  ylab = \"SvO2\",\n  title = \"(B)\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#D95F02\")\n)\n\n\np3 <- ggwithinstats(                     #boxplot of chi comparison between regions\n  data = comp_chisep_chi,\n  x = Vein,\n  y = Chi, \n  pairwise.display = \"all\",\n  results.subtitle = FALSE,\n  xlab = \"Region\",\n  ylab = \"Chi\",\n  title = \"(C)\",\n  subtitle = \"                                                n.s.\",\n  type = \"nonparametric\", \n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#1B9E77\")\n)\n\n\np4 <- ggwithinstats(                    #boxplot of svo2 comparison between regions\n  data = comp_chisep_CSvO2,\n  x = Vein,\n  y = CSvO2, \n  pairwise.display = \"all\",\n  results.subtitle = FALSE,\n  xlab = \"Region\",\n  ylab = \"SvO2\",\n  title = \"(D)\",\n  subtitle = \"                                                n.s.\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#1B9E77\")\n)\n\n\ncombine_plots(\n  plotlist = list(p1, p2, p3, p4),\n  plotgrid.args = list(nrow = 2)\n)\n```\n\n::: {.cell-output-display}\n![](gavin_thesis_markdown_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsave.image('results.RData')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n p1 <- ggwithinstats(\n  data = comp_legit_starfsl,\n  x = Vein,\n  y = Chi,\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"Chi\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#D95F02\")) + \n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_legit_starfsl$Chi)*1.05), size=4, label = \"***\")\n\np2 <- ggwithinstats(\n  data = comp_SSS_IntVein_CSvO2,\n  x = Vein,\n  y = CSvO2,\n  results.subtitle = FALSE,\n  type = \"p\",\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"SvO2\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#D95F02\")\n) + \n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_SSS_IntVein_CSvO2$CSvO2)*1.05), size=4, label = \"***\")\n\n\np3 <- ggwithinstats(                     #boxplot of chi comparison between regions\n  data = comp_chisep_chi,\n  x = Vein,\n  y = Chi, \n  results.subtitle = FALSE,\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"Chi\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#1B9E77\")\n) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_chisep_chi$Chi))*1.05, size=4, label = \"n.s.\")\n\n\np4 <- ggwithinstats(                    #boxplot of svo2 comparison between regions\n  data = comp_chisep_CSvO2,\n  x = Vein,\n  y = CSvO2, \n  results.subtitle = FALSE,\n  pairwise.display = \"all\",\n  bf.message = FALSE,\n  xlab = \"Region\",\n  ylab = \"SvO2\",\n  type = \"nonparametric\",\n  centrality.plotting = FALSE,\n  point.path.args = list(linewidth = 0.25, linetype = \"solid\"),\n  point.args = list(color = \"#1B9E77\")\n) +\n  ggplot2::annotate(\"text\", x=1.5, y=(max(comp_chisep_CSvO2$CSvO2)*1.05), size=4, label = \"n.s.\")\n\n(patch1 <- (p1 + p2)/(p3 + p4))\n```\n\n::: {.cell-output-display}\n![](gavin_thesis_markdown_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# patch1\n# ggsave('figure.png', patch1)\n```\n:::\n\n::: {#cell-fig-regionplot .cell}\n\n```{.r .cell-code}\n#| label: fig-regionplot\n#| fig-width: 8\n#| fig-height: 5\n#| fig-cap: \"rmarkdown test figure\"\npatch1\n```\n\n::: {.cell-output-display}\n![rmarkdown test figure](gavin_thesis_markdown_files/figure-html/fig-regionplot-1.png){#fig-regionplot width=768}\n:::\n:::\n",
    "supporting": [
      "gavin_thesis_markdown_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}